<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; media-src 'self' blob:; connect-src 'self'; worker-src 'self' blob:;">
    <title>OTTER Proof of Concept</title>
    <link rel="stylesheet" href="./style.css" />
  </head>
  <body>
    <header>
      <img src="assets/BannerIcon.png">

      <button id="btnChoose">Choose Audio…</button>
      <button id="btnTranscribe" disabled>Transcribe</button>

      <span class="headerDivider"></span>
      <button id="btnRemove" disabled title="Remove selected words (Delete)">Remove</button>
      <button id="btnRestore" disabled title="Restore removed words">Restore</button>
      <span class="headerDivider"></span>
      <button id="btnUndo" disabled title="Undo (⌘Z)">Undo</button>
      <button id="btnRedo" disabled title="Redo (⌘⇧Z)">Redo</button>
      <span class="headerDivider"></span>
      <button id="btnSaveEdl" disabled title="Save EDL to file">Save EDL</button>
      <button id="btnLoadEdl" title="Load EDL from file">Load EDL</button>
      <button id="btnSaveEdits" disabled title="Export edited audio to new file">Save Edits</button>

      <div class="statusArea">
        <div id="status"></div>
        <progress id="transcribeProgress" value="0" max="100" hidden></progress>
      </div>
    </header>

    <main>
      <!-- LEFT COLUMN: Waveforms + Dev Panel -->
      <section class="wavePane">
        <div class="waveBlock">
          <div id="waveform"></div>

          <div class="transport" id="primaryTransport">
            <div class="transportGroup left">
              <label>Play Track</label>
              <button id="btnPlay" disabled aria-label="Play/Pause" title="Play/Pause">▶︎</button>
            </div>
            <div class="transportGroup center">
              <span id="time" class="numericReadout">0.00</span>
            </div>
            <div class="transportGroup right">
              <span id="loadedFile">No file loaded</span>
            </div>
          </div>
        </div>

        <hr id="detailDivider" hidden>
        
        <div id="waveDetailPane" hidden>
          <div class="waveBlock">

            <div id="waveDetail"></div>

            <div class="transport" id="detailTransport">
              <div class="transportGroup left">
                <label>Play Region</label>
                <button id="btnDetailPlay" disabled
                        aria-label="Play/Pause Detail"
                        title="Play/Pause Detail">▶︎</button>
              </div>

              <div class="transportGroup center">
                <span class="numericReadout" id="detailTime"></span>
              </div>

              <div class="transportGroup right">
                <label>Play Selection</label>
                <button id="btnRegion" disabled
                        aria-label="Play Region"
                        title="Play Region">▷</button>
                <span id="detailBounds" class="numericReadout">[— - —]</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Developer Panel (collapsed by default) -->
        <details id="devPanel" class="devPanel">
          <summary>
            <span class="devTitle">Developer Controls</span>
            <span class="devHint">Transcription Pipeline and Log</span>
          </summary>

          <div class="devBody">
            <!-- Spec controls -->
            <div class="devSection">
              <div class="devSectionTitle">Transcription Pipeline</div>

              <div class="devRow">
                <label for="specSelect">Spec:</label>
                <select id="specSelect"></select>

                <label class="checkbox">
                  <input type="checkbox" id="chkCustomSpec" />
                  Customize
                </label>
              </div>

              <div id="customSpecArea" hidden>
                <textarea id="specJson" spellcheck="false"></textarea>
              </div>
            </div>

            <!-- Transcription Log -->
            <div class="devSection">
              <div class="devSectionTitle">Transcription Log</div>
              <pre id="log"></pre>
            </div>
          </div>
        </details>
      </section>

      <!-- RIGHT COLUMN: Transcript only -->
      <section class="textPane">
        <div class="paneTitle">Transcript</div>
        <div id="transcript"></div>
      </section>
    </main>

    <script src="./node_modules/wavesurfer.js/dist/wavesurfer.min.js"></script>
    <script src="./node_modules/wavesurfer.js/dist/plugins/regions.min.js"></script>
    <script type="module" src="./dist/renderer.js"></script>
  </body>
</html>
